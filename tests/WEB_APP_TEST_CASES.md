# 智能售后工作台 Web 端自动化测试用例（可执行版）

## 文档说明
- **版本**: v3.0
- **更新日期**: 2026-01-27
- **适用系统**: 智能售后工作台主前端系统 (app.html)
- **测试范围**: 前端 E2E + API + 集成 + 轻量性能
- **参考文档**: `docs/prd/backend/事件格式.md`

## 目标与约束
- **目标**: 将所有业务流程与细分功能点转化为可自动化执行的用例，支持 CI/CD 运行。
- **约束**: UI 视觉/体验类无法稳定自动化的内容移至“仅 UI 层手工测试用例”。

## 优先级定义
- **P0**: 核心功能，必须通过，影响核心业务流程
- **P1**: 重要功能，应该通过，影响用户体验
- **P2**: 次要功能，可延后，不影响核心功能

## 用例字段说明（统一格式）
- **用例ID**: 模块缩写-序号（例如 `NAV-001`）
- **类型**: E2E / API / 集成 / 性能 / 可靠性
- **前置条件**: 数据、权限、页面状态
- **步骤**: 可脚本化的操作步骤
- **期望结果**: 可断言的 UI/接口/存储结果
- **自动化实现提示**: 关键接口、断言点、选择器建议

## 测试环境
- **浏览器**: Chrome 120+, Firefox 120+, Safari 17+
- **分辨率**: 1920x1080, 1366x768
- **网络**: 正常、弱网、离线（可通过 DevTools/代理模拟）

## 测试数据准备（必须可重置）
- **账号**: test@example.com / Test@123456
- **角色**:客服(`cs`)、质检(`quality_specialist`)、主管(`leadership`)、管理员(`admin`)
- **客户**: 10 个客户（含等级/风险/标签差异）
- **对话**: 50 条对话（含不同状态/渠道/未读）
- **知识**: 100 条知识条目（含分类/标签/FAQ）
- **需求**: 20 条（含不同状态/优先级）
- **任务**: 10 条（含派发/处理状态）
- **事件**: domain_events + outbox_events 基础数据

## 模块索引
- [0. 全局导航与布局](#0-全局导航与布局)
- [1. 登录与会话](#1-登录与会话)
- [2. 权限体系](#2-权限体系)
- [3. 对话列表与会话](#3-对话列表与会话)
- [4. 客户画像](#4-客户画像)
- [5. 需求管理](#5-需求管理)
- [6. 任务与质检](#6-任务与质检)
- [7. 知识库管理](#7-知识库管理)
- [8. 知识应用](#8-知识应用)
- [9. AI 辅助](#9-ai-辅助)
- [10. 工具箱](#10-工具箱)
- [11. 报表](#11-报表)
- [12. 审计与监控](#12-审计与监控)
- [13. 健康检查](#13-健康检查)
- [14. 权限面板](#14-权限面板)
- [15. 工具箱快捷动作](#15-工具箱快捷动作)
- [16. 运行时配置](#16-运行时配置)
- [17. 可靠性与异常处理](#17-可靠性与异常处理)
- [18. 实时通信与SSE](#18-实时通信与sse)
- [19. Agent协同与智能辅助](#19-agent协同与智能辅助)
- [20. 问题并行管理](#20-问题并行管理)
- [21. 事件溯源与一致性](#21-事件溯源与一致性)
- [22. 性能与负载](#22-性能与负载)
- [23. 细分功能点自动化覆盖清单](#23-细分功能点自动化覆盖清单)
- [24. 仅 UI 层手工测试用例](#24-仅-ui-层手工测试用例)

---

## 0. 全局导航与布局

### NAV-001 进入模块工作区（消息/知识/工具/报表/权限）
- **类型**: E2E **优先级**: P0
- **前置条件**: 已登录（角色为 admin）
- **步骤**:
  1. 依次点击 Dock 入口：消息、知识、工具、报表、权限。
  2. 对“知识”进入后切换子菜单“知识应用”。
- **期望结果**:
  - 左侧/工作区内容与入口一致
  - 当前入口高亮，仅一个高亮
- **自动化实现提示**: 断言 workspace 关键容器 `data-testid` 存在与标题文本

### NAV-002 Dock 子菜单切换（消息->任务 / 知识->知识应用）
- **类型**: E2E **优先级**: P0
- **前置条件**: 已登录
- **步骤**:
  1. 在消息 Dock 内切换子菜单到“任务”。
  2. 在知识 Dock 内切换子菜单到“知识应用”。
- **期望结果**: 左侧列表与工作区更新为对应模块
- **自动化实现提示**: 断言页面 URL/hash 或 `data-active-module`

### NAV-003 角色切换影响模块可见性
- **类型**: E2E **优先级**: P0
- **前置条件**: 具备角色切换权限
- **步骤**:
  1. 切换为 `quality_specialist`。
  2. 切换为 `leadership`。
- **期望结果**:
  - `quality_specialist` 隐藏报表入口、显示任务入口
  - `leadership` 隐藏任务入口、显示报表入口
- **自动化实现提示**: 通过 DOM 断言入口存在/不可见

### NAV-004 右侧抽屉分析/AI 面板切换
- **类型**: E2E **优先级**: P0
- **前置条件**: 已登录，处于消息页
- **步骤**:
  1. 打开右侧抽屉，切换到 AI 面板。
  2. 切回分析面板。
  3. 点击遮罩关闭。
- **期望结果**: 只有一个面板可见；关闭后面板隐藏
- **自动化实现提示**: 断言面板 `data-panel=ai|analysis` 可见性

### NAV-005 左/右分隔线调整宽度
- **类型**: E2E **优先级**: P1
- **前置条件**: 已登录
- **步骤**:
  1. 拖拽分隔线到最小/最大边界。
- **期望结果**: 宽度限制生效且不报错
- **自动化实现提示**: Playwright drag；断言宽度范围

### NAV-006 用户菜单开合
- **类型**: E2E **优先级**: P1
- **步骤**:
  1. 点击头像/用户名打开菜单。
  2. 点击页面空白关闭。
- **期望结果**: 菜单正确开合

### NAV-A11Y-001 Dock 键盘操作
- **类型**: E2E **优先级**: P2
- **步骤**:
  1. Tab 聚焦 Dock 按钮，Enter 激活。
- **期望结果**: 对应模块打开

---

## 1. 登录与会话

### AUTH-001 邮箱/手机号登录成功
- **类型**: E2E **优先级**: P0
- **前置条件**: 账号有效
- **步骤**:
  1. 输入有效邮箱/手机号与密码提交。
- **期望结果**:
  - 跳转到 `app.html`
  - localStorage 写入 `authToken`
  - 用户信息显示正确
- **自动化实现提示**: 断言 URL、localStorage、用户名文本

### AUTH-002 登录失败提示
- **类型**: E2E **优先级**: P0
- **步骤**: 输入错误密码登录
- **期望结果**: 提示“登录失败/账号或密码错误”

### AUTH-003 Token 失效处理
- **类型**: E2E **优先级**: P0
- **步骤**:
  1. 清空 token 后刷新工作台。
  2. `GET /api/auth/me` 返回 401。
- **期望结果**: 清理本地存储并跳转登录

### AUTH-004 退出登录
- **类型**: E2E **优先级**: P0
- **步骤**: 点击退出
- **期望结果**: localStorage 清空，跳转登录

### AUTH-005 表单校验（空值/格式/长度/复杂度）
- **类型**: E2E **优先级**: P0
- **步骤**: 依次输入空账号/非法邮箱/非法手机号/弱密码/不足8位
- **期望结果**: 对应字段错误提示出现

### AUTH-006 接口异常提示
- **类型**: E2E **优先级**: P1
- **步骤**: 登录接口返回 500/网络异常
- **期望结果**: 提示“服务暂不可用/无法连接认证服务”

### AUTH-A11Y-001 表单可访问性
- **类型**: E2E **优先级**: P2
- **步骤**: 触发错误提示后观察 `aria-live`
- **期望结果**: 错误提示可被读屏读取

---

## 2. 权限体系

### RBAC-001 权限接口返回与 UI 渲染
- **类型**: 集成 **优先级**: P0
- **步骤**:
  1. 调用 `GET /session/permissions`。
  2. 进入权限页面。
- **期望结果**: UI 权限与接口一致

### RBAC-002 无权限入口隐藏/禁用
- **类型**: E2E **优先级**: P0
- **步骤**: 使用客服角色进入系统
- **期望结果**: 权限入口隐藏；`data-permission-mode=disable` 置灰不可点

### RBAC-003 权限变更即时生效
- **类型**: E2E **优先级**: P0
- **步骤**:
  1. 切换角色。
  2. 观察 Dock 与权限面板。
- **期望结果**: 可见模块/按钮同步更新

### RBAC-004 无权限操作返回 403
- **类型**: API **优先级**: P0
- **步骤**: 使用无权限账号调用受限接口
- **期望结果**: 返回 403，前端提示权限不足

### RBAC-005 uiPermissions 优先策略
- **类型**: 集成 **优先级**: P1
- **步骤**: 构造权限接口返回 uiPermissions 与 permissions 不一致
- **期望结果**: UI 以 uiPermissions 渲染

---

## 3. 对话列表与会话

### MSG-001 初始加载与默认高亮
- **类型**: E2E **优先级**: P0
- **步骤**: 进入消息页
- **期望结果**: 列表加载，首条高亮，消息区展示对应会话

### MSG-002 对话切换同步画像
- **类型**: E2E **优先级**: P0
- **步骤**: 点击任意对话
- **期望结果**: 消息区与右侧客户画像同步更新

### MSG-003 搜索与筛选
- **类型**: E2E **优先级**: P0
- **步骤**:
  1. 输入关键词搜索。
  2. 切换状态/渠道/紧急度/客户等级筛选。
  3. 清空搜索和筛选。
- **期望结果**: 列表按条件过滤并可恢复全量；无匹配显示空态

### MSG-004 发送消息与校验
- **类型**: E2E **优先级**: P0
- **步骤**:
  1. 输入消息发送。
  2. 尝试发送空消息。
  3. 发送超长消息（接口返回400）。
- **期望结果**: 发送成功后消息出现在底部；空消息被拦截；超长提示错误

### MSG-005 表情面板
- **类型**: E2E **优先级**: P1
- **步骤**: 打开表情面板，点击空白关闭
- **期望结果**: 面板开合正常

### MSG-006 快捷操作入口
- **类型**: E2E **优先级**: P1
- **步骤**: 点击工单/问题澄清/需求检测/辅助排查/创建工单/故障报告
- **期望结果**: 打开对应弹窗或占位提示

### MSG-007 模式切换
- **类型**: E2E **优先级**: P0
- **步骤**:
  1. 切换 Agent 模式（auto/supervised/human）。
  2. 观察当前高亮。
- **期望结果**: 模式更新、提示成功、接口 `PATCH /im/conversations/:id/mode` 调用

### MSG-008 风险提示
- **类型**: E2E **优先级**: P1
- **步骤**: 输入包含“赠送/优惠/折扣”关键词
- **期望结果**: 出现低置信/风险提示

### MSG-A11Y-001 输入框快捷键
- **类型**: E2E **优先级**: P2
- **步骤**: Enter 发送，Shift+Enter 换行
- **期望结果**: 行为正确

---

## 4. 客户画像

### PROF-001 画像加载与缺省兜底
- **类型**: E2E **优先级**: P1
- **步骤**: 切换对话并加载画像
- **期望结果**: 信息完整；缺失字段显示“-”

### PROF-002 互动记录与筛选
- **类型**: E2E **优先级**: P1
- **步骤**: 切换互动记录筛选（时间窗/类型）
- **期望结果**: 列表更新

### PROF-003 详情弹窗与定位
- **类型**: E2E **优先级**: P1
- **步骤**:
  1. 打开服务记录详情。
  2. 点击“定位”。
- **期望结果**: 关闭侧栏并定位到消息（高亮）

### PROF-004 刷新画像
- **类型**: E2E **优先级**: P1
- **步骤**: 点击“刷新画像”
- **期望结果**: 更新时间变化，接口 `POST /api/customers/:id/refresh`

---

## 5. 需求管理

### REQ-001 列表与统计加载
- **类型**: E2E **优先级**: P1
- **步骤**: 打开需求面板
- **期望结果**: 统计卡与列表渲染

### REQ-002 扫描需求
- **类型**: E2E **优先级**: P1
- **步骤**: 点击“扫描需求”
- **期望结果**: 列表更新或提示

### REQ-003 创建/忽略需求
- **类型**: E2E **优先级**: P1
- **步骤**: 对未处理需求执行“创建卡片/忽略”
- **期望结果**: 列表状态更新

### REQ-004 筛选与空态
- **类型**: E2E **优先级**: P1
- **步骤**: 切换状态筛选
- **期望结果**: 列表更新；无数据时显示空态

---

## 6. 任务与质检

### TASK-001 质检概览与空态
- **类型**: E2E **优先级**: P1
- **步骤**: 进入任务页
- **期望结果**: 概览卡加载，空态提示显示

### TASK-002 指令派发与日志
- **类型**: E2E **优先级**: P1
- **步骤**:
  1. 切换到“对话驱动任务”。
  2. 输入指令并派发。
- **期望结果**: 日志新增记录；接口 `POST /api/tasks`

### TASK-003 空指令校验
- **类型**: E2E **优先级**: P1
- **步骤**: 输入为空点击派发
- **期望结果**: 警告提示

---

## 7. 知识库管理

### KB-001 分类树加载与切换
- **类型**: E2E **优先级**: P1
- **步骤**: 进入知识管理页并切换分类
- **期望结果**: 列表过滤与面包屑更新

### KB-002 新建/删除分类
- **类型**: E2E **优先级**: P1
- **步骤**:
  1. 新建分类（含空值/重名校验）。
  2. 删除分类并确认。
- **期望结果**: 分类树更新；删除后知识迁移到默认分类

### KB-003 文档创建/上传/删除
- **类型**: E2E **优先级**: P1
- **步骤**:
  1. 上传单文件/多文件。
  2. 观察进度条与成功提示。
  3. 删除文档并确认。
- **期望结果**: 列表更新；失败可重试

### KB-004 文档搜索与排序
- **类型**: E2E **优先级**: P1
- **步骤**: 输入关键词搜索、切换排序
- **期望结果**: 列表按条件刷新

### KB-005 FAQ 创建与相似问题
- **类型**: E2E **优先级**: P1
- **步骤**: 新增 FAQ/相似问题
- **期望结果**: 详情中可见相似问题列表

### KB-006 权限不足处理
- **类型**: E2E **优先级**: P1
- **步骤**: 使用无权限账号访问
- **期望结果**: 按钮隐藏或置灰

---

## 8. 知识应用

### KBU-001 搜索与结果预览
- **类型**: E2E **优先级**: P1
- **步骤**: 输入关键词搜索并点击结果
- **期望结果**: 详情预览区展示内容

### KBU-002 复制内容
- **类型**: E2E **优先级**: P1
- **步骤**: 点击“复制内容”
- **期望结果**: 提示成功/失败（文案 2s 后恢复）

### KBU-003 空结果与清空
- **类型**: E2E **优先级**: P1
- **步骤**: 搜索无结果并清空
- **期望结果**: 空态提示，清空后恢复初始

---

## 9. AI 辅助

### AI-001 面板加载与刷新
- **类型**: E2E **优先级**: P1
- **步骤**: 打开 AI 面板并切换对话
- **期望结果**: 自动拉取并刷新分析

### AI-002 采纳建议写入输入框
- **类型**: E2E **优先级**: P1
- **步骤**: 点击“采纳建议”
- **期望结果**: 内容写入输入框

### AI-003 子区域切换
- **类型**: E2E **优先级**: P1
- **步骤**: 切换回复/方案/行动/澄清/需求/情绪/参考资料
- **期望结果**: 对应区域展示

### AI-004 情绪分析同步到列表
- **类型**: E2E **优先级**: P1
- **步骤**: 获取情绪分析结果
- **期望结果**: 列表情绪 icon 更新

---

## 10. 工具箱

### TOOL-001 服务状态监控
- **类型**: E2E **优先级**: P2
- **步骤**: 打开监控弹窗并处理告警
- **期望结果**: 告警从列表移除，提示成功

### TOOL-002 生成报告
- **类型**: E2E **优先级**: P2
- **步骤**: 点击“生成报告”
- **期望结果**: 审计汇总弹窗展示

### TOOL-003 诊断/日志/会话
- **类型**: E2E **优先级**: P2
- **步骤**: 打开各功能弹窗
- **期望结果**: 加载态->结果展示

---

## 11. 报表

### REPORT-001 图表渲染与切换
- **类型**: E2E **优先级**: P2
- **步骤**: 进入报表页并切换 tabs
- **期望结果**: 图表渲染且不串页

---

## 12. 审计与监控

### AUDIT-001 写操作生成审计
- **类型**: 集成 **优先级**: P2
- **步骤**: 触发任意写操作后查询 `/audit/reports/summary`
- **期望结果**: 总数递增

### AUDIT-002 告警创建与处理
- **类型**: API **优先级**: P2
- **步骤**: `POST /monitoring/alerts` -> `PATCH /monitoring/alerts/:id/resolve`
- **期望结果**: 告警状态更新

---

## 13. 健康检查

### HEALTH-001 健康检查响应
- **类型**: API **优先级**: P2
- **步骤**: 访问 `/health`
- **期望结果**: `status=healthy`

### HEALTH-002 Metrics 输出
- **类型**: API **优先级**: P2
- **步骤**: 访问 `/metrics`
- **期望结果**: Content-Type 为 `text/plain`

---

## 14. 权限面板

### PERM-001 成员/角色加载与搜索
- **类型**: E2E **优先级**: P1
- **步骤**: 打开权限页并搜索成员
- **期望结果**: 列表过滤正确

### PERM-002 权限勾选与保存
- **类型**: E2E **优先级**: P1
- **步骤**: 勾选权限并保存
- **期望结果**: 提示成功并更新预览

### PERM-003 成员/角色增删改
- **类型**: E2E **优先级**: P1
- **步骤**: 新增/编辑/删除成员与角色
- **期望结果**: 列表同步更新；系统角色不可删除

---

## 15. 工具箱快捷动作

### QUICK-001 系统通知/工单/升级问题
- **类型**: E2E **优先级**: P2
- **步骤**: 打开弹窗并提交
- **期望结果**: 提示成功或返回错误提示

### QUICK-002 弹窗关闭
- **类型**: E2E **优先级**: P2
- **步骤**: ESC/关闭按钮
- **期望结果**: 弹窗关闭

---

## 16. 运行时配置

### RUNTIME-001 API 地址覆盖
- **类型**: 集成 **优先级**: P1
- **步骤**: 修改 `public/runtime-config.js` 中 API 地址
- **期望结果**: 前端请求走新地址

### RUNTIME-002 代理转发
- **类型**: 集成 **优先级**: P1
- **步骤**: 调用 `/api/v1` 走 Vite 代理
- **期望结果**: 转发成功

### RUNTIME-003 缺省配置提示
- **类型**: E2E **优先级**: P1
- **步骤**: 移除 API 配置后访问系统
- **期望结果**: 提示 “API not configured”

---

## 17. 可靠性与异常处理

### REL-001 超时与重试
- **类型**: 可靠性 **优先级**: P0
- **步骤**: 模拟 408/504
- **期望结果**: 自动重试 3 次，总耗时 < 8s

### REL-002 断网与降级
- **类型**: 可靠性 **优先级**: P0
- **步骤**: 断网访问列表/消息
- **期望结果**: “网络异常”提示与降级内容

---

## 18. 实时通信与SSE

### SSE-001 SSE 建连与重连
- **类型**: 集成 **优先级**: P0
- **步骤**: 订阅 `/im/reviews/stream` 并断线重连
- **期望结果**: 自动重连并继续接收事件

### SSE-002 ReviewRequest 推送
- **类型**: 集成 **优先级**: P0
- **步骤**: 触发低置信建议 -> SSE 推送
- **期望结果**: 前端显示复核任务

### SSE-003 消息实时推送
- **类型**: 集成 **优先级**: P1
- **步骤**: 模拟新消息推送
- **期望结果**: 对话列表与消息区实时更新

### SSE-004 失败降级为轮询
- **类型**: 集成 **优先级**: P1
- **步骤**: SSE 连接失败
- **期望结果**: 自动降级为轮询并提示

---

## 19. Agent协同与智能辅助

### AGENT-001 路由决策
- **类型**: 集成 **优先级**: P0
- **步骤**: 输入简单/复杂/紧急问题
- **期望结果**: 路由到 simple/agent_supervised/human_first

### AGENT-002 Assistant 建议与引用
- **类型**: 集成 **优先级**: P0
- **步骤**: 请求分析建议
- **期望结果**: 包含知识库引用，低置信触发复核

### AGENT-003 EngineerAgent 诊断与工单
- **类型**: 集成 **优先级**: P1
- **步骤**: 模拟故障输入
- **期望结果**: 输出根因分析并创建工单

### AGENT-004 InspectorAgent 质检
- **类型**: 集成 **优先级**: P1
- **步骤**: 完结问题触发质检
- **期望结果**: 生成质检报告，可查询

### AGENT-005 降级策略
- **类型**: 可靠性 **优先级**: P0
- **步骤**: 模拟 AgentScope 不可用
- **期望结果**: 降级到 LLM 或人工提示，并记录日志

---

## 20. 问题并行管理

### PROB-001 问题识别与创建
- **类型**: 集成 **优先级**: P0
- **步骤**: 输入含多个问题的对话
- **期望结果**: 创建多个问题记录并写入事件表

### PROB-002 状态流转
- **类型**: E2E **优先级**: P0
- **步骤**: 按流程流转 new -> in_progress -> waiting_customer -> resolved -> reopened
- **期望结果**: 状态同步与事件记录

### PROB-003 问题与工单关联
- **类型**: 集成 **优先级**: P0
- **步骤**: 高优先级问题创建工单
- **期望结果**: 工单与问题关联，状态同步

### PROB-004 并行展示与筛选
- **类型**: E2E **优先级**: P0
- **步骤**: 切换问题、按状态/优先级筛选
- **期望结果**: 列表与详情一致

---

## 21. 事件溯源与一致性

### ES-001 写入 domain_events + outbox_events
- **类型**: 集成 **优先级**: P1
- **步骤**: 创建对话/消息/需求/任务/问题
- **期望结果**: domain_events 与 outbox_events 同步写入

### ES-002 Outbox 投递与重试
- **类型**: 集成 **优先级**: P1
- **步骤**: 模拟投递失败并重试
- **期望结果**: 状态流转 pending -> processing -> completed

### ES-003 事件一致性校验
- **类型**: 集成 **优先级**: P1
- **步骤**: 比对 domain_events 与 outbox_events
- **期望结果**: 数量/内容/时间戳一致

---

## 22. 性能与负载

### PERF-001 首屏与关键交互
- **类型**: 性能 **优先级**: P0
- **步骤**: 运行 Lighthouse
- **期望结果**: 首屏 < 3s，关键交互 < 500ms

### PERF-002 大数据量加载
- **类型**: 性能 **优先级**: P1
- **步骤**: 预置 1000+ 对话、100+ 消息、1000+ 知识
- **期望结果**: 列表渲染不卡顿

### PERF-003 内存与长连接
- **类型**: 性能 **优先级**: P1
- **步骤**: SSE 长连接 1h，观察内存
- **期望结果**: 无明显泄漏

---

## 23. 细分功能点自动化覆盖清单

> 以下条目为“细分功能点”的参数化覆盖清单，需由上述用例套件以数据驱动方式全部覆盖。

### 23.1 登录与会话（AUTH 参数集）
- 账号为空/格式非法/手机号非法/密码为空/密码不足 8 位/弱密码
- 邮箱正则：`[^\\s@]+@[^\\s@]+\\.[^\\s@]+`，手机号正则：`^1[3-9]\\d{9}$`
- 错误码映射：400 表单错误，401 账号密码错误，403 账号禁用，500 服务不可用
- 登录接口网络异常提示
- 登录性能：95% < 2s

### 23.2 权限体系（RBAC 参数集）
- 未登录访问权限接口返回 401
- 无权限操作返回 403
- `data-permission-mode=disable` 置灰不可点
- 当前激活入口被隐藏时自动回退到消息页
- uiPermissions 优先渲染规则

### 23.3 对话列表与会话（MSG 参数集）
- 列表项字段：客户名/摘要/更新时间/渠道/情绪 icon/未读数
- 搜索过滤：客户名/摘要
- 筛选维度：状态/渠道/紧急度/客户等级
- AI 面板开关与对话切换同步
- 风险词触发低置信提示
- 异常码映射：400/401/403/404/500
- 性能：列表 < 2s，切换 95% < 1s

### 23.4 客户画像（PROF 参数集）
- `/api/customers/:id` 与 `/api/customers/:id/interactions` 拉取
- 缺失字段显示“-”不崩溃
- 风险/等级色彩状态
- 互动记录倒序、筛选维度（时间窗/类型）
- 异常码映射：400/401/403/404
- 性能：画像加载 < 1.5s

### 23.5 需求管理（REQ 参数集）
- 状态枚举：pending/approved/resolved/ignored/cancelled
- 分类枚举：feature/bug/improvement/question
- 标题长度 2-200
- 接口失败降级为 mock
- 异常码映射：400/401/403/404
- 性能：列表加载 < 2s

### 23.6 任务与质检（TASK 参数集）
- 空指令禁止派发
- 派发失败保留输入
- 侧栏任务列表空态
- 接口：`POST /api/tasks`、`GET /api/tasks`、`POST /api/tasks/:id/actions`

### 23.7 知识库管理（KB 参数集）
- 分类名长度 2-40，重名校验
- 上传文件类型/大小校验
- FAQ 生成数量范围 1-20
- 分类切换重置分页/滚动
- 删除分类知识迁移默认分类
- 上传进度与失败重试
- 权限不足隐藏/置灰
- 异常码映射：400/401/403/404
- 性能：列表加载 < 2s

### 23.8 知识应用（KBU 参数集）
- 搜索关键词为空不触发
- 搜索关键词长度上限 100
- 无结果空态
- 异常码映射：400/401/500
- 性能：95% < 1.5s

### 23.9 AI 辅助（AI 参数集）
- 分析上下文为空提示/默认
- 模型名称枚举校验
- 异常码映射：400/401/500
- 性能：分析 < 3s

### 23.10 工具箱（TOOL 参数集）
- 告警级别：info/warning/critical
- 无权限入口隐藏或提示
- 异常码映射：401/403/500
- 性能：告警列表加载 < 2s

### 23.11 报表（REPORT 参数集）
- 图表数据为空提示“暂无数据”
- 图表容器标题可读
- 页面渲染 < 2s

### 23.12 审计与监控（AUDIT 参数集）
- action/resource 为空返回 400
- action 枚举为 HTTP 方法
- 审计汇总响应 < 1s
- 401/403 权限提示

### 23.13 健康检查（HEALTH 参数集）
- `/metrics` 失败返回 500 并记录错误
- 健康检查响应 < 200ms

### 23.14 权限面板（PERM 参数集）
- 角色名/成员名为空禁止保存
- 角色描述长度 0-100
- 新增成员需密码且邮箱/手机号必填其一
- 系统角色不可删除
- 渲染 < 1.5s

### 23.15 工具箱快捷动作（QUICK 参数集）
- 文本输入长度上限 500
- 关闭弹窗支持 ESC
- 打开弹窗 < 300ms

### 23.16 运行时配置（RUNTIME 参数集）
- 代理异常提示“网络异常”
- runtime-config 不阻塞首屏

### 23.17 可靠性（REL 参数集）
- 429 限流提示
- JSON 解析异常提示明确

### 23.18 实时通信与SSE（SSE 参数集）
- 心跳保活
- 多标签页独立连接
- 推送延迟：消息 < 500ms，ReviewRequest < 1s
- 降级为轮询并可自动恢复

### 23.19 Agent协同（AGENT 参数集）
- 路由决策记录 domain_events
- 质检报告保存 quality_reports
- MCP 工具调用失败有明确提示
- 性能：建议 < 3s，情绪 < 1s，质检 < 5s

### 23.20 问题并行管理（PROB 参数集）
- 状态流转写入 domain_events
- OutboxProcessor 投递事件到 EventBus
- 质检结果关联问题与对话
- 性能：识别 < 2s，创建 < 500ms，流转 < 300ms

### 23.21 事件溯源（ES 参数集）
- 重试间隔 1s/2s/4s
- 查询与重放能力
- 事件查询 < 500ms

### 23.22 性能与负载（PERF 参数集）
- 渲染 1000+ 列表不卡顿
- 连续点击不重复提交
- 长时间运行内存不泄漏
- SSE 长连接不泄漏

---

## 24. 仅 UI 层手工测试用例

> 以下内容无法稳定自动化，需人工在 UI 层执行并记录结果。

### UI-001 视觉一致性与排版
- **范围**: 字体/字号/行高/对齐/间距
- **步骤**: 检查主要页面（消息/知识/任务/权限/报表）
- **期望结果**: 视觉对齐与间距符合设计规范，无明显错位

### UI-002 色彩与状态样式
- **范围**: 高亮/禁用/错误/成功状态色
- **步骤**: 触发各状态（禁用按钮、错误提示、成功提示）
- **期望结果**: 颜色与强调层级合理且一致

### UI-003 图表可读性
- **范围**: 折线/柱状/指标卡
- **步骤**: 查看图表在不同分辨率的显示
- **期望结果**: 标签不重叠，比例清晰可读

### UI-004 动画与过渡体验
- **范围**: 抽屉、弹窗、列表加载动效
- **步骤**: 快速连续操作开合
- **期望结果**: 动画流畅，无卡顿/抖动/闪烁

### UI-005 拖拽交互手感
- **范围**: 分隔线拖拽、上传拖拽
- **步骤**: 拖拽多次并观察反馈
- **期望结果**: 阻尼与反馈自然、无误触

### UI-006 输入体验与文案
- **范围**: 占位符、提示文案、空态文案
- **步骤**: 触发空态/错误提示
- **期望结果**: 文案清晰、无错别字、语义一致

### UI-007 兼容性与渲染差异
- **范围**: Chrome/Firefox/Safari
- **步骤**: 关键页面截图对比
- **期望结果**: 样式无明显差异，不影响使用

### UI-008 非常规网络体验
- **范围**: 弱网/丢包
- **步骤**: 手动切换网络模拟
- **期望结果**: Loading/重试/错误提示体验合理

---

## 执行建议
- P0：每次提交触发（E2E + API + 集成）
- P1：每日执行（夜间构建）
- P2：每周执行（回归）

## CI/CD 集成建议
- GitHub Actions / GitLab CI
- 失败阻断：P0
- 失败告警：P1
